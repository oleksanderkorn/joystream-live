(this["webpackJsonpjoystream-validator-stats"]=this["webpackJsonpjoystream-validator-stats"]||[]).push([[0],{582:function(t,e,n){},590:function(t,e){},592:function(t,e){},596:function(t,e){},599:function(t,e){},600:function(t,e){},658:function(t,e){},661:function(t,e){},663:function(t,e){},673:function(t,e){},675:function(t,e){},701:function(t,e){},703:function(t,e){},708:function(t,e){},710:function(t,e){},716:function(t,e){},718:function(t,e){},730:function(t,e){},733:function(t,e){},747:function(t,e){},750:function(t,e){},758:function(t,e,n){},764:function(t,e,n){"use strict";n.r(e);var a=n(351),r=n(52),c=n(0),i=n.n(c),s=n(47),o=n.n(s),u=n(186),l=n(15),d=n(21),b=n.n(d),h=n(36),f=n(1),p=(n(582),n(320)),j=n.n(p);j.a.defaultFormat="YYYY-MM-DD HH:mm:ss";var x=n(4),m=n(9),v=n(835),O=n(840),g=n(532),k=n(537),y=n(254),w=n.n(y);Object(k.config)();var S=function(){function t(e){Object(x.a)(this,t),this.endpoint=void 0,this.isReady=void 0,this.api=void 0;var n=e||"wss://joystreamstats.live:9945";this.endpoint=n,this.isReady=Object(h.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new v.a({provider:new O.a(n),types:g.types}).isReadyOrError;case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})))()}return Object(m.a)(t,[{key:"init",get:function(){var t=this;return this.isReady.then((function(e){return t.api=e,t}))}},{key:"totalIssuance",value:function(){var t=Object(h.a)(b.a.mark((function t(e){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e){t.next=6;break}return t.next=3,this.api.query.balances.totalIssuance();case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,this.api.query.balances.totalIssuance.at(e);case 8:t.t0=t.sent;case 9:return n=t.t0,t.abrupt("return",n.toNumber());case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"systemData",value:function(){var t=Object(h.a)(b.a.mark((function t(){var e,n,a,r,c;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([this.api.rpc.system.chain(),this.api.rpc.system.name(),this.api.rpc.system.version()]);case 2:return e=t.sent,n=Object(f.a)(e,3),a=n[0],r=n[1],c=n[2],t.abrupt("return",{chain:a.toString(),nodeName:r.toString(),nodeVersion:c.toString()});case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"finalizedHash",value:function(){var t=Object(h.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.api.rpc.chain.getFinalizedHead());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"finalizedBlockHeight",value:function(){var t=Object(h.a)(b.a.mark((function t(){var e,n,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.finalizedHash();case 2:return e=t.sent,t.next=5,this.api.rpc.chain.getHeader("".concat(e));case 5:return n=t.sent,a=n.number,t.abrupt("return",a.toNumber());case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getActiveErasForBlock",value:function(){var t=Object(h.a)(b.a.mark((function t(e,n){var a,r,c,i,s,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e,t.next=3,this.api.rpc.chain.getBlockHash(n);case 3:return r=t.sent,t.next=6,this.api.query.staking.activeEra.at(r);case 6:return c=t.sent.unwrap().index.toNumber(),t.t0=Date,t.next=10,this.api.query.timestamp.now.at(r);case 10:return t.t1=t.sent.toNumber(),i=new t.t0(t.t1).toISOString(),t.next=14,this.api.query.staking.erasRewardPoints.at(r,c);case 14:return s=t.sent,o=void 0,s.individual.forEach((function(t,e){if("Author Points [".concat(e,"]"),"Individual Points [".concat(t,"]"),e.toString()===a){var s=Number(t.toBigInt()),u={id:n,era:c,hash:r.toString(),block:n,date:i,points:s};"Era [".concat(u.era,"], Block [").concat(u.block,"], Date [").concat(u.date,"], Points [").concat(u.points,"], Hash [").concat(u.hash,"]"),o=u}})),t.abrupt("return",o);case 18:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"findActiveValidators",value:function(){var t=Object(h.a)(b.a.mark((function t(e,n){var a,r,c,i,s,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.rpc.chain.getBlock(e);case 2:a=t.sent,r=a.block.header.number.toNumber();case 4:return t.next=6,this.api.rpc.chain.getBlockHash(r);case 6:return i=t.sent,t.next=9,this.api.query.staking.snapshotValidators.at(i);case 9:if((s=t.sent).isEmpty){t.next=15;break}return t.next=13,this.api.query.staking.validatorCount.at(i);case 13:o=t.sent.toNumber(),c=Array.from(s.unwrap()).slice(0,o);case 15:n?--r:++r;case 16:if(void 0===c){t.next=4;break}case 17:return t.abrupt("return",c);case 18:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"validatorsData",value:function(){var t=Object(h.a)(b.a.mark((function t(){var e,n,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.query.session.validators();case 2:return e=t.sent,t.next=5,this.api.query.staking.currentEra();case 5:if(!(n=t.sent).isSome){t.next=12;break}return t.next=9,this.api.query.staking.erasTotalStake(n.unwrap());case 9:t.t0=t.sent,t.next=13;break;case 12:t.t0=new w.a(0);case 13:return a=t.t0,t.abrupt("return",{count:e.length,validators:e.toJSON(),total_stake:a.toNumber()});case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),N=n(34);function E(t){return Promise.all(Object.entries(t).map((function(t){var e=Object(f.a)(t,2),n=e[0],a=e[1];return a instanceof Promise?a.then((function(t){return[n,t]})):new Promise((function(t){return t([n,a])}))}))).then((function(t){return t.reduce((function(t,e){var n=Object(f.a)(e,2),a=n[0],r=n[1];return Object(u.a)(Object(u.a)({},t),{},Object(N.a)({},a,r))}),{})}))}var B=new S;function C(){return D.apply(this,arguments)}function D(){return(D=Object(h.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.init;case 2:return t.t0=E,t.next=5,B.totalIssuance();case 5:return t.t1=t.sent,t.next=8,B.finalizedBlockHeight();case 8:return t.t2=t.sent,t.next=11,B.validatorsData();case 11:return t.t3=t.sent,t.next=14,B.systemData();case 14:return t.t4=t.sent,t.t5={totalIssuance:t.t1,finalizedBlockHeight:t.t2,validators:t.t3,system:t.t4},t.next=18,(0,t.t0)(t.t5);case 18:return e=t.sent,t.abrupt("return",e);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(t,e){return H.apply(this,arguments)}function H(){return(H=Object(h.a)(b.a.mark((function t(e,n){var a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.init;case 2:return t.t0=E,t.next=5,B.getActiveErasForBlock(e,n);case 5:return t.t1=t.sent,t.t2={status:t.t1},t.next=9,(0,t.t0)(t.t2);case 9:return a=t.sent,t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var z=n(829),P=n(830),q=n(839),A=n(831),F=n(832),L=n(540),R=n(17),W=n(823),T=Object(R.a)({root:{boxShadow:"none",textTransform:"none",fontSize:16,padding:"6px 12px",border:"1px solid",lineHeight:1.5,color:"#ffffff",backgroundColor:"#4138ff",borderColor:"#4138ff",fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{backgroundColor:"#4138dd",borderColor:"#4138dd",boxShadow:"none"},"&:active":{boxShadow:"none",backgroundColor:"#4138ee",borderColor:"#4138ee"},"&:focus":{boxShadow:"0 0 0 0.2rem rgba(0,123,255,.5)"}}})(W.a),V=n(837),Y=n(824),J=n(553),M=n(27);function U(t,e,n){return 100*(Number(t)-Number(e))/(Number(n)-Number(e))}function Z(t){return t.value>0?Object(M.jsx)("div",{style:{width:"98%"},children:Object(M.jsxs)(V.a,{display:"flex",alignItems:"center",children:[Object(M.jsx)(V.a,{width:"100%",mr:1,children:Object(M.jsx)(Y.a,{variant:"determinate",value:U(t.value,t.min,t.max)})}),Object(M.jsx)(V.a,{minWidth:35,style:{whiteSpace:"nowrap"},children:Object(M.jsx)(J.a,{variant:"body2",color:"textSecondary",children:"".concat(Math.round(U(t.value,t.min,t.max)),"% (").concat(t.value,"/").concat(t.max,")")})})]})}):null}var G=n(838),K=n(825),X=n(826),_=n(827),Q=n(828),$=Object(K.a)({root:{minWidth:"98%",textAlign:"left"},title:{fontSize:18},pos:{marginBottom:12,marginTop:12}}),tt=function(t){var e=$(),n=t.activeEras,a=void 0,r=void 0,c="";return t.activeEras.length>0?(a=(n=t.activeEras.sort((function(t,e){return t.block-e.block})))[0],r=n[n.length-1],c="Validator Date: ".concat(new Date(a.date).toLocaleDateString(),"-").concat(new Date(r.date).toLocaleDateString(),"\nDescription: I was an active validator from era/block ").concat(a.era,"/").concat(a.block," to era/block ").concat(r.era,"/").concat(r.block,"\nwith stash account ").concat(t.stash,". (I was active in all the eras in this range and found a total of ? blocks)"),Object(M.jsxs)(X.a,{className:e.root,children:[Object(M.jsxs)(_.a,{children:[Object(M.jsx)(J.a,{className:e.title,color:"textPrimary",gutterBottom:!0,children:"Scoring period text:"}),c.split("\n").map((function(t,n){return Object(M.jsx)(J.a,{className:e.pos,color:"textSecondary",children:t},n)}))]}),Object(M.jsx)(Q.a,{children:Object(M.jsx)(W.a,{onClick:function(){return navigator.clipboard.writeText(c)},size:"small",children:"Copy to clipboard"})})]})):Object(M.jsx)(X.a,{className:e.root,children:Object(M.jsx)(_.a,{children:Object(M.jsx)(J.a,{className:e.pos,color:"textSecondary",children:"No Data Available"})})})},et=function(){var t=Object(c.useState)(!1),e=Object(f.a)(t,2),n=e[0],a=e[1],r=Object(c.useState)(!0),i=Object(f.a)(r,2),s=i[0],o=i[1],d=Object(c.useState)([]),p=Object(f.a)(d,2),j=p[0],x=p[1],m=Object(c.useState)([{field:"era",headerName:"Era",width:100,sortable:!0},{field:"block",headerName:"Block",width:100,sortable:!0},{field:"date",headerName:"Date",width:200,sortable:!0},{field:"points",headerName:"Points",width:100,sortable:!0},{field:"hash",headerName:"Block Hash",width:500,sortable:!1}]),v=Object(f.a)(m,1)[0],O=Object(c.useState)("5EhDdcWm4TdqKp1ew1PqtSpoAELmjbZZLm5E34aFoVYkXdRW"),g=Object(f.a)(O,2),k=g[0],y=g[1],w=Object(c.useState)(1274283),S=Object(f.a)(w,2),N=S[0],E=S[1],B=Object(c.useState)(1274383),D=Object(f.a)(B,2),H=D[0],R=D[1],W=Object(c.useState)(!1),V=Object(f.a)(W,2),Y=V[0],J=V[1],U=Object(c.useState)(0),K=Object(f.a)(U,2),X=K[0],_=K[1],Q=Object(c.useState)({value:0,min:0,max:0}),$=Object(f.a)(Q,2),et=$[0],nt=$[1],at=Object(c.useState)([]),rt=Object(f.a)(at,2),ct=rt[0],it=rt[1];Object(c.useEffect)((function(){st();var t=setInterval((function(){st()}),1e4);return function(){return clearInterval(t)}}),[]);var st=function(){var t=Object(h.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C();case 2:e=t.sent,_(e.finalizedBlockHeight),it(e.validators.validators);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ot=function(t,e){return Number(N)<Number(H)?s&&e?t+600<Number(H)?t+600:Number(H):s?t+10:t+1:s&&e?t-600<Number(H)?t-600:Number(H):s?t-10:t-1},ut=function(){var t=Object(h.a)(b.a.mark((function t(){var e,n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:pt(),e=!1,n=b.a.mark((function t(n){var r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!1,a((function(t){return r=t})),!r){t.next=5;break}return dt(),t.abrupt("return","break");case 5:return t.next=7,bt(Number(n));case 7:e=t.sent,n===Number(H)&&lt();case 9:case"end":return t.stop()}}),t)})),r=Number(N)<Number(H)?s?Number(N)-600<0?0:Number(N)-600:Number(N):s?Number(N)+600:Number(N);case 4:return t.delegateYield(n(r),"t0",5);case 5:if("break"!==t.t0){t.next=8;break}return t.abrupt("break",11);case 8:r=ot(r,e),t.next=4;break;case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),lt=function(){n||(a(!0),J(!1))},dt=function(){a(!1),J(!1),nt({value:0,min:0,max:0})},bt=function(){var t=Object(h.a)(b.a.mark((function t(e){var n,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ft(e),t.next=3,I(k,e);case 3:return n=t.sent,(a=n&&n.status&&j.indexOf(n.status)<0)&&x((function(t){return[].concat(Object(l.a)(t),[n.status])})),ht(e),t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ht=function(t){t.toString()===H.toString()&&J(!1)},ft=function(t){nt({value:t,min:s?N-600:N,max:H})},pt=function(){J(!0),x([])},jt=!k||!N||!H,xt=X>0?"End Block (Last block: ".concat(X,")"):"End Block";return Object(M.jsx)(z.a,{maxWidth:"lg",children:Object(M.jsxs)(P.a,{container:!0,spacing:2,children:[Object(M.jsx)(P.a,{item:!0,xs:12,lg:12,children:Object(M.jsx)("h1",{children:"Live Stats"})}),Object(M.jsx)(P.a,{item:!0,xs:12,lg:12,children:Object(M.jsx)(G.a,{fullWidth:!0,freeSolo:!0,options:ct,onChange:function(t,e){return y(e||"")},value:k,renderInput:function(t){return Object(M.jsx)(q.a,Object(u.a)(Object(u.a)({},t),{},{label:"Validator stash address",variant:"filled"}))}})}),Object(M.jsx)(P.a,{item:!0,xs:4,lg:5,children:Object(M.jsx)(q.a,{fullWidth:!0,type:"number",onChange:function(t){return E(t.target.value)},id:"block-start",label:"Start Block",value:N,variant:"filled"})}),Object(M.jsx)(P.a,{item:!0,xs:4,lg:2,children:Object(M.jsx)(A.a,{control:Object(M.jsx)(F.a,{checked:s,onChange:function(t){return o(t.target.checked)},name:"searchOptimized",color:"primary"}),disabled:Y,label:s?"Optimized search":"Full search"})}),Object(M.jsx)(P.a,{item:!0,xs:4,lg:5,children:Object(M.jsx)(q.a,{fullWidth:!0,type:"number",onChange:function(t){return R(t.target.value)},id:"block-end",label:xt,value:H,variant:"filled"})}),Object(M.jsx)(P.a,{item:!0,xs:12,lg:12,children:Object(M.jsx)(T,{size:"large",style:{minHeight:56},disabled:jt,fullWidth:!0,onClick:function(){return Y?lt():ut()},color:"primary",children:Y?"Stop loading":"Load data"})}),Object(M.jsx)(P.a,{item:!0,xs:12,lg:12,children:Object(M.jsx)(Z,Object(u.a)({},et))}),Object(M.jsx)(P.a,{item:!0,xs:12,lg:12,children:Object(M.jsx)(tt,{stash:k,activeEras:j})}),Object(M.jsx)(P.a,{item:!0,xs:12,lg:12,children:Object(M.jsx)("div",{style:{height:600},children:Object(M.jsx)(L.a,{rows:j,columns:v,pageSize:50})})})]})})},nt=(n(758),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,843)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,i=e.getTTFB;n(t),a(t),r(t),c(t),i(t)}))}),at=n(833),rt=n(820),ct=n(834),it=n.p+"static/media/joystream.e2f4466b.svg";o.a.render(Object(M.jsx)(i.a.StrictMode,{children:Object(M.jsxs)(r.a,{children:[Object(M.jsx)("div",{style:{flexGrow:1},children:Object(M.jsx)(at.a,{position:"static",style:{flexDirection:"row",backgroundColor:"#4138ff"},children:Object(M.jsxs)(rt.a,{style:{paddingLeft:"12px",backgroundColor:"#4138ff"},children:[Object(M.jsx)(W.a,{color:"inherit",component:a.a,to:"/",children:Object(M.jsx)("img",{style:{width:50,height:50},src:it,className:"App-logo",alt:"Joystream logo"})}),Object(M.jsx)(W.a,{color:"inherit",component:a.a,to:"/",children:"Validator Report"}),Object(M.jsx)(W.a,{color:"inherit",component:a.a,to:"/live",children:"Live Stats"})]})})}),Object(M.jsx)("div",{children:Object(M.jsxs)(r.d,{children:[Object(M.jsx)(r.b,{path:"/live",children:Object(M.jsx)(et,{})}),Object(M.jsx)(r.b,{path:"/",children:Object(M.jsx)(z.a,{maxWidth:"lg",children:Object(M.jsx)(P.a,{container:!0,spacing:2,children:Object(M.jsx)(J.a,{variant:"h2",style:{marginTop:"1rem",color:"#fff",textAlign:"center",backgroundColor:"#4138ff",border:"1px solid #4138ff",borderRadius:12,padding:4},children:Object(M.jsx)(ct.a,{style:{color:"#fff",padding:4},href:"https://joystreamstats.live/validator-report",children:"Validator Report is now part of Joystream Stats"})})})})})]})})]})}),document.getElementById("root")),nt()}},[[764,1,2]]]);
//# sourceMappingURL=main.eaa19f34.chunk.js.map