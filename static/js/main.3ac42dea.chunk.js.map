{"version":3,"sources":["joystream.svg","debug.ts","joyApi.ts","utils.ts","get-status.ts","BootstrapButton.tsx","LinearProgressWithLabel.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["moment","defaultFormat","config","JoyApi","endpoint","isReady","api","wsEndpoint","process","this","a","ApiPromise","provider","WsProvider","types","isReadyOrError","then","instance","blockHash","undefined","query","balances","totalIssuance","at","issuance","toNumber","Promise","all","rpc","system","chain","name","version","peers","nodeName","nodeVersion","toString","peerCount","length","getFinalizedHead","finalizedHash","getHeader","number","address","blockStart","stash","getBlockHash","startHash","staking","activeEra","startEra","unwrap","index","Date","timestamp","now","startTimestamp","toISOString","erasRewardPoints","eraPoints","data","individual","forEach","points","author","pn","Number","toBigInt","id","era","hash","block","date","searchPreviousBlocks","getBlock","currentBlockNr","header","currentHash","snapshotValidators","allValidators","isEmpty","validatorCount","max","activeValidators","Array","from","slice","session","validators","currentEra","isSome","erasTotalStake","BN","totalStake","count","toJSON","total_stake","PromiseAllObj","obj","Object","entries","map","key","val","res","reduce","acc","value","getChainState","init","finalizedBlockHeight","validatorsData","status","getValidatorStatistics","getActiveErasForBlock","BootstrapButton","withStyles","root","boxShadow","textTransform","fontSize","padding","border","lineHeight","color","backgroundColor","borderColor","fontFamily","join","Button","normalise","min","LinearProgressWithLabel","props","Grid","container","item","lg","style","width","Box","display","alignItems","mr","LinearProgress","variant","minWidth","whiteSpace","Typography","Math","round","JoystreamApp","useState","shouldStop","setShouldStop","activeEras","setActiveEras","field","headerName","sortable","headerAlign","columns","setStash","startBlock","setStartBlock","endBlock","setEndBlock","isLoading","setIsLoading","lastBlock","setLastBlock","progress","setProgress","setActiveValidators","useEffect","updateChainState","interval","setInterval","clearInterval","chainState","fetchBlocksData","resetDataBeforeLoading","blockHeight","shouldStopLoading","prev","resetProgress","fetchBlockData","updateProgress","result","indexOf","prevEras","stopLoadingOnLastBlock","shouldDisableButton","endBlockLabel","className","Container","maxWidth","direction","justify","spacing","src","joystream","alt","Autocomplete","freeSolo","options","onChange","e","renderInput","params","TextField","label","type","target","fullWidth","disabled","onClick","height","rows","pageSize","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3ac42dea.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/joystream.f5df567f.svg\";","import moment from 'moment';\n\nmoment.defaultFormat = 'YYYY-MM-DD HH:mm:ss';\n\nexport const log = (...values: any[]) => {\n    // console.log(`[${moment().format()}]:`, ...values);\n}\n\nexport const error = (...values: any[]) => {\n    console.error(`[${moment().format()}]:`, ...values);\n}","import { WsProvider, ApiPromise } from \"@polkadot/api\";\nimport { types } from \"@joystream/types\";\nimport { AccountId, Hash } from \"@polkadot/types/interfaces\";\nimport { config } from \"dotenv\";\nimport BN from \"bn.js\";\nimport { Option, Vec } from \"@polkadot/types\";\nimport { log } from \"./debug\"\nimport { ActiveEra } from \"./Types\";\n\nconfig();\n\nexport class JoyApi {\n  endpoint: string;\n  isReady: Promise<ApiPromise>;\n  api!: ApiPromise;\n\n  constructor(endpoint?: string) {\n    const wsEndpoint = endpoint || process.env.REACT_APP_WS_PROVIDER || \"ws://127.0.0.1:9944\";\n    this.endpoint = wsEndpoint;\n    this.isReady = (async () => {\n      const api = await new ApiPromise({ provider: new WsProvider(wsEndpoint), types })\n        .isReadyOrError;\n      return api;\n    })();\n  }\n  get init(): Promise<JoyApi> {\n    return this.isReady.then((instance) => {\n      this.api = instance;\n      return this;\n    });\n  }\n\n  async totalIssuance(blockHash?: Hash) {\n    const issuance =\n      blockHash === undefined\n        ? await this.api.query.balances.totalIssuance()\n        : await this.api.query.balances.totalIssuance.at(blockHash);\n\n    return issuance.toNumber();\n  }\n\n  async systemData() {\n    const [chain, nodeName, nodeVersion, peers] = await Promise.all([\n      this.api.rpc.system.chain(),\n      this.api.rpc.system.name(),\n      this.api.rpc.system.version(),\n      this.api.rpc.system.peers(),\n    ]);\n\n    return {\n      chain: chain.toString(),\n      nodeName: nodeName.toString(),\n      nodeVersion: nodeVersion.toString(),\n      peerCount: peers.length,\n    };\n  }\n\n  async finalizedHash() {\n    return this.api.rpc.chain.getFinalizedHead();\n  }\n\n  async finalizedBlockHeight() {\n    const finalizedHash = await this.finalizedHash();\n    const { number } = await this.api.rpc.chain.getHeader(`${finalizedHash}`);\n    return number.toNumber();\n  }\n\n  async getActiveErasForBlock(address: string, blockStart: number): Promise<ActiveEra[] | undefined> {\n    const stash = address;\n    const startHash = (await this.api.rpc.chain.getBlockHash(blockStart));\n    const startEra = (await this.api.query.staking.activeEra.at(startHash)).unwrap().index.toNumber();\n    const startTimestamp = new Date((await this.api.query.timestamp.now.at(startHash)).toNumber()).toISOString();\n    const eraPoints = await this.api.query.staking.erasRewardPoints.at(startHash, startEra)\n    let data = undefined\n    eraPoints.individual.forEach((points, author) => {\n      log(`Author Points [${author}]`);\n      log(`Individual Points [${points}]`);\n      if (author.toString() === stash) {\n        const pn = Number(points.toBigInt())\n        const activeEra: ActiveEra = {\n          id: blockStart,\n          era: startEra,\n          hash: startHash.toString(),\n          block: blockStart,\n          date: startTimestamp,\n          points: pn\n        }\n        log(`Era [${activeEra.era}], Block [${activeEra.block}], Date [${activeEra.date}], Points [${activeEra.points}], Hash [${activeEra.hash}]`);\n        data = activeEra\n      }\n    });\n    return data\n  }\n\n  async findActiveValidators(hash: Hash, searchPreviousBlocks: boolean): Promise<AccountId[]> {\n    const block = await this.api.rpc.chain.getBlock(hash);\n\n    let currentBlockNr = block.block.header.number.toNumber();\n    let activeValidators;\n    do {\n      let currentHash = (await this.api.rpc.chain.getBlockHash(currentBlockNr)) as Hash;\n      let allValidators = await this.api.query.staking.snapshotValidators.at(currentHash) as Option<Vec<AccountId>>;\n      if (!allValidators.isEmpty) {\n        let max = (await this.api.query.staking.validatorCount.at(currentHash)).toNumber();\n        activeValidators = Array.from(allValidators.unwrap()).slice(0, max);\n      }\n\n      if (searchPreviousBlocks) {\n        --currentBlockNr;\n      } else {\n        ++currentBlockNr;\n      }\n\n    } while (activeValidators === undefined);\n    return activeValidators;\n  }\n\n  async validatorsData() {\n    const validators = await this.api.query.session.validators();\n    const era = await this.api.query.staking.currentEra();\n    const totalStake = era.isSome ?\n      await this.api.query.staking.erasTotalStake(era.unwrap())\n      : new BN(0);\n\n    return {\n      count: validators.length,\n      validators: validators.toJSON(),\n      total_stake: totalStake.toNumber(),\n    };\n  }\n}\n","const fromEntries = (xs: [string | number | symbol, any][]) =>\n  xs.reduce((acc, [key, value]) => ({ ...acc, [key]: value }), {});\n\nexport function PromiseAllObj(obj: {\n  [k: string]: any;\n}): Promise<{ [k: string]: any }> {\n  return Promise.all(\n    Object.entries(obj).map(([key, val]) =>\n      val instanceof Promise\n        ? val.then((res) => [key, res])\n        : new Promise((res) => res([key, val]))\n    )\n  ).then((res: any[]) => fromEntries(res));\n}\n","import { log } from \"./debug\";\nimport { JoyApi } from \"./joyApi\";\nimport { EraStatus } from \"./Types\";\nimport { PromiseAllObj } from \"./utils\";\n\nconst api = new JoyApi();\n\nexport async function getChainState() {\n  await api.init;\n\n  const status = await PromiseAllObj({\n    totalIssuance: await api.totalIssuance(),\n    finalizedBlockHeight: await api.finalizedBlockHeight(),\n    validators: await api.validatorsData()\n    // system: await api.systemData(),\n  });\n\n  log(status)\n  return status;\n}\n\nexport async function getValidatorStatistics(address: string, blockStart: number): Promise<EraStatus> {\n  await api.init;\n  const status = await PromiseAllObj({\n    status: await api.getActiveErasForBlock(address, blockStart)\n  })\n  return status as unknown as EraStatus\n}\n","import { Button, withStyles } from '@material-ui/core';\n\nexport const BootstrapButton = withStyles({\n  root: {\n    boxShadow: 'none',\n    textTransform: 'none',\n    fontSize: 16,\n    padding: '6px 12px',\n    border: '1px solid',\n    lineHeight: 1.5,\n    color: '#ffffff',\n    backgroundColor: '#4138ff',\n    borderColor: '#4138ff',\n    fontFamily: [\n      '-apple-system',\n      'BlinkMacSystemFont',\n      '\"Segoe UI\"',\n      'Roboto',\n      '\"Helvetica Neue\"',\n      'Arial',\n      'sans-serif',\n      '\"Apple Color Emoji\"',\n      '\"Segoe UI Emoji\"',\n      '\"Segoe UI Symbol\"',\n    ].join(','),\n    '&:hover': {\n      backgroundColor: '#4138dd',\n      borderColor: '#4138dd',\n      boxShadow: 'none',\n    },\n    '&:active': {\n      boxShadow: 'none',\n      backgroundColor: '#4138ee',\n      borderColor: '#4138ee',\n    },\n    '&:focus': {\n      boxShadow: '0 0 0 0.2rem rgba(0,123,255,.5)',\n    },\n  },\n})(Button);\n","import { Box, Grid, LinearProgress, LinearProgressProps, Typography } from '@material-ui/core';\n\nexport function normalise(value: number, min: number, max: number) {\n  return (value - min) * 100 / (max - min);\n}\n\nexport function LinearProgressWithLabel(props: LinearProgressProps & { value: number; min: number; max: number; }) {\n  return props.value > 0 ? (\n    <Grid container item lg={12}>\n      <div style={{ width: '98%' }}>\n        <Box display=\"flex\" alignItems=\"center\">\n          <Box width=\"100%\" mr={1}>\n            <LinearProgress variant=\"determinate\" value={normalise(props.value, props.min, props.max)} />\n          </Box>\n          <Box minWidth={35} style={{ whiteSpace: \"nowrap\" }}>\n            <Typography variant=\"body2\" color=\"textSecondary\">\n              {`${Math.round(normalise(props.value, props.min, props.max))}% (${props.value}/${props.max})`}\n            </Typography>\n          </Box>\n        </Box>\n      </div>\n    </Grid>\n  ) : null;\n}\n","import joystream from './joystream.svg';\nimport './App.css';\nimport { getValidatorStatistics, getChainState } from './get-status';\nimport { Container, Grid, TextField } from '@material-ui/core';\nimport { ColDef, DataGrid } from '@material-ui/data-grid';\nimport { BootstrapButton } from './BootstrapButton';\nimport { LinearProgressWithLabel } from './LinearProgressWithLabel';\nimport { ActiveEra } from './Types';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport { useEffect, useState } from 'react';\n\nconst JoystreamApp = () => {\n  const [shouldStop, setShouldStop] = useState(false);\n  const [activeEras, setActiveEras] = useState([] as ActiveEra[]);\n  const [columns] = useState(\n    [\n      { field: 'era', headerName: 'Era', width: 100, sortable: true, headerAlign: 'center' },\n      { field: 'block', headerName: 'Block', width: 100, sortable: true, headerAlign: 'center' },\n      { field: 'date', headerName: 'Date', width: 200, sortable: true, headerAlign: 'center' },\n      { field: 'points', headerName: 'Points', width: 100, sortable: true, headerAlign: 'center' },\n      { field: 'hash', headerName: 'Block Hash', width: 500, sortable: false, headerAlign: 'center' },\n    ]\n  );\n  const [stash, setStash] = useState('5EhDdcWm4TdqKp1ew1PqtSpoAELmjbZZLm5E34aFoVYkXdRW');\n  const [startBlock, setStartBlock] = useState(1270157); //1069639\n  const [endBlock, setEndBlock] = useState(1270177);\n  const [isLoading, setIsLoading] = useState(false);\n  const [lastBlock, setLastBlock] = useState(0);\n  const [progress, setProgress] = useState({\n    value: 0,\n    min: 0,\n    max: 0\n  });\n  const [activeValidators, setActiveValidators] = useState([]);\n\n  useEffect(() => {\n    updateChainState()\n    const interval = setInterval(() => () => updateChainState(), 10000);\n    return () => clearInterval(interval);\n  });\n\n  const updateChainState = async () => {\n    const chainState = await getChainState();\n    setLastBlock(chainState.finalizedBlockHeight)\n    setActiveValidators(chainState.validators.validators)\n  }\n\n  const fetchBlocksData = async () => {\n    resetDataBeforeLoading();\n\n    if (startBlock < endBlock) {\n      for (let blockHeight = startBlock; blockHeight <= endBlock; blockHeight += 1) {\n        let shouldStopLoading = false\n        setShouldStop(prev => {\n          shouldStopLoading = prev\n          return prev\n        })\n        if (shouldStopLoading) {\n          resetProgress();\n          break;\n        }\n        await fetchBlockData(blockHeight);\n      }\n    } else {\n      for (let blockHeight = startBlock; blockHeight >= endBlock; blockHeight -= 1) {\n        let shouldStopLoading = false\n        setShouldStop(prev => {\n          shouldStopLoading = prev\n          return prev\n        })\n        if (shouldStopLoading) {\n          resetProgress();\n          break;\n        }\n        await fetchBlockData(blockHeight);\n      }\n    }\n  }\n\n  const stopFetchingBlocksData = () => {\n    if (!shouldStop) {\n      setShouldStop(true)\n      setIsLoading(false)\n    }\n  }\n\n  const resetProgress = () => {\n    setShouldStop(false)\n    setProgress({ value: 0, min: 0, max: 0 })\n  }\n\n  const fetchBlockData = async (blockHeight: number) => {\n    updateProgress(blockHeight, );\n    let result = await getValidatorStatistics(stash, blockHeight);\n    if (result && result.status && activeEras.indexOf(result.status) < 0) {\n      setActiveEras((prevEras) => [...prevEras, result.status])\n    }\n    stopLoadingOnLastBlock(blockHeight);\n  }\n\n  const stopLoadingOnLastBlock = (blockHeight: number) => {\n    if (blockHeight.toString() === endBlock.toString()) {\n      setIsLoading(false)\n    }\n  }\n\n  const updateProgress = (blockHeight: number) => {\n    setProgress({ value: blockHeight, min: startBlock, max: endBlock })\n  }\n\n  const resetDataBeforeLoading = () => {\n    setIsLoading(true)\n    setActiveEras([])\n  }\n\n  const shouldDisableButton = !stash || !startBlock || !endBlock;\n  const endBlockLabel = lastBlock > 0 ? `End Block (Last block: ${lastBlock})` : 'End Block';\n\n  const updateStartBlock = (e: { target: { value: unknown; }; }) => setStartBlock((e.target.value as unknown as number));\n  const updateEndblock = (e: { target: { value: unknown; }; }) => setEndBlock((e.target.value as unknown as number));\n  return (\n    <div className=\"App\" >\n      <Container maxWidth=\"lg\">\n        <Grid\n          container\n          direction=\"column\"\n          justify=\"center\"\n          alignItems=\"center\"\n          spacing={3}\n        >\n          <Grid container item lg={12}></Grid>\n          <img src={joystream} className=\"App-logo\" alt=\"Joystream logo\" />\n          <Grid container item lg={12}>\n            <Autocomplete\n              freeSolo\n              style={{ width: '100%' }}\n              options={activeValidators}\n              onChange={(e, value) => setStash(value || '')}\n              value={stash}\n              renderInput={(params) => <TextField {...params} label=\"Validator stash address\" variant=\"filled\" />} />\n          </Grid>\n          <Grid container item lg={12}>\n            <TextField type=\"number\" onChange={updateStartBlock} fullWidth id=\"block-start\" label=\"Start Block\" value={startBlock} variant=\"filled\" />\n          </Grid>\n          <Grid container item lg={12}>\n            <TextField type=\"number\" onChange={updateEndblock} fullWidth id=\"block-end\" label={endBlockLabel} value={endBlock} variant=\"filled\" />\n          </Grid>\n          <Grid container item lg={12}>\n            <BootstrapButton disabled={shouldDisableButton} fullWidth onClick={() => isLoading ? stopFetchingBlocksData() : fetchBlocksData()} color=\"primary\">{isLoading ? 'Stop loading' : 'Load data'}</BootstrapButton>\n          </Grid>\n          <LinearProgressWithLabel {...progress} />\n          <div style={{ height: 600, width: '98%' }}>\n            <DataGrid rows={activeEras} columns={columns as unknown as ColDef[]} pageSize={50} />\n          </div>\n        </Grid>\n      </Container>\n    </div>\n  );\n}\n\nexport default JoystreamApp","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport JoystreamApp from './App';\nimport './index.css';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <JoystreamApp />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}